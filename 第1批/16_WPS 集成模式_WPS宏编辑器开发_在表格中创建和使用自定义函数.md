# 自定义函数

尽管 WPS 表格包含大量内置工作表函数，但它可能没有适用于您执行的每种类型的计算的函数，因此 WPS 宏编辑器提供了创建自定义函数的功能。

宏编辑器里的自定义函数和宏类似，不同的是

1.它们执行计算而不是操作，所以某些类型的语句，例如设置单元格的值、修改选区等不建议写在自定义函数中。

2.宏通常不会有参数和返回值，而函数在参数上没有限制，往往是有返回值的。

下面以求矩形面积的函数为例。

## 插入代码

在代码模块中插入代码：

``` JavaScript
function 计算面积(长, 宽)
{
       if (宽 == undefined)
              return 长*长
       else
              return 长*宽
}
```

![](Base64图像/Base64图像10来自_WPS%20集成模式_WPS宏编辑器开发_在表格中创建和使用自定义函数.png)

## 使用函数

点击编辑栏的插入函数按钮，在弹出的插入函数对话框中，选择类别为“用户定义”，选中刚刚新增的“计算面积”函数，点击“确定”，在函数参数中输入长、宽的值，或是引用对应的单元格，点击"确定”即可完成函数插入操作，并自动计算

![](Base64图像/Base64图像11来自_WPS%20集成模式_WPS宏编辑器开发_在表格中创建和使用自定义函数.png)

![](Base64图像/Base64图像12来自_WPS%20集成模式_WPS宏编辑器开发_在表格中创建和使用自定义函数.png)

![](Base64图像/Base64图像13来自_WPS%20集成模式_WPS宏编辑器开发_在表格中创建和使用自定义函数.png)

> WPS 开发文档： [WPS 集成模式/WPS宏编辑器开发/在表格中创建和使用自定义函数](https://qn.cache.wpscdn.cn/encs/doc/office_v19/topics/WPS%20%E9%9B%86%E6%88%90%E6%A8%A1%E5%BC%8F/WPS%E5%AE%8F%E7%BC%96%E8%BE%91%E5%99%A8%E5%BC%80%E5%8F%91/%E5%9C%A8%E8%A1%A8%E6%A0%BC%E4%B8%AD%E5%88%9B%E5%BB%BA%E5%92%8C%E4%BD%BF%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0.html)

------------------------------------------------------------------------
