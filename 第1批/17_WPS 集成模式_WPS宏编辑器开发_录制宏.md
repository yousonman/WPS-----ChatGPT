# 录制宏

WPS 宏编辑器提供了一个自动生成 JS 代码的功能，即录制宏。录制宏功能通过宏录制器捕捉用户与 WPS 交互的操作，并以 JS 代码的形式记录下来，整个过程是自动的，不需要用户写代码。在实际的 WPS 二次开发过程中，此方法使用频率很高。当你不知道如何写 JS 代码时，只需录制下来，打开编辑器，查看代码即可。

因为宏录制器是通过捕获你大部分操作来生成代码，因此如果操作顺序中出现错误，例如点击了一个本不打算点击的按钮，宏录制器也会录制该错误操作。解决方法是重新录制整个操作，或直接修改 JS 代码。因此，录制内容前，最好先确保你的操作熟练，这样录制时操作越流畅，生成的宏越精简，运行宏时就越高效。

操作步骤：

1.切换到“开发工具”选项卡——点击“切换到 JS 环境”（如果有需要的话）——点击“录制新宏”按钮。——在弹出的“录制 JS 宏”对话框中，填写宏名，说明等宏信息，或者使用默认的信息。然后点击确定，进入宏录制状态。

![](Base64图像/Base64图像14来自_WPS%20集成模式_WPS宏编辑器开发_录制宏.png)

2.进入宏录制状态后，原有的按钮变成 “停止录制”，这是我们就可以进行操作了，这里我们以设置单元格边框为例。操作完成后，不要进行其他操作，切换到“开发工具”选项卡，点击“停止录制”按钮，录制宏就完成了。

![](Base64图像/Base64图像15来自_WPS%20集成模式_WPS宏编辑器开发_录制宏.png)

3.如需修改或是查看，可以切换到“开发工具”选项卡，点击“ WPS 宏编辑器”按钮，打开宏编辑器的主界面，查看代码。

![](Base64图像/Base64图像16来自_WPS%20集成模式_WPS宏编辑器开发_录制宏.png)

> WPS 开发文档： [WPS 集成模式/WPS宏编辑器开发/录制宏](https://qn.cache.wpscdn.cn/encs/doc/office_v19/topics/WPS%20%E9%9B%86%E6%88%90%E6%A8%A1%E5%BC%8F/WPS%E5%AE%8F%E7%BC%96%E8%BE%91%E5%99%A8%E5%BC%80%E5%8F%91/%E5%BD%95%E5%88%B6%E5%AE%8F.html)

------------------------------------------------------------------------
