# 代码调试

宏编辑器提供设置断点、查看堆栈、查看变量、单步、步进、步出等功能来辅助开发者查看代码执行情况，从而便于他们快速定位代码问题。

## 设置断点

在代码行号左侧空白处状态区，点击即可切换行断点状态，右键单击不仅可以设置行断点，还可以设置条件断点。

![](Base64图像/Base64图像38来自_WPS%20集成模式_WPS宏编辑器开发_界面组成_主体功能窗口区_代码调试.png)

![](Base64图像/Base64图像39来自_WPS%20集成模式_WPS宏编辑器开发_界面组成_主体功能窗口区_代码调试.png)

## 查看调用堆栈

当代码执行中断时，例如在断点中断时，即可使用堆栈功能。

在堆栈窗口中能够展示堆栈上每一帧所在代码的文档名、代码模块名称、具体函数名称以及行号信息。双击任一帧将会激活帧所在代码的窗口，并定位到对应的行。

![](Base64图像/Base64图像40来自_WPS%20集成模式_WPS宏编辑器开发_界面组成_主体功能窗口区_代码调试.png)

## 查看变量

中断时，在监视窗口或是立即窗口输入变量名后回车，可以查看变量的值：

![](Base64图像/Base64图像41来自_WPS%20集成模式_WPS宏编辑器开发_界面组成_主体功能窗口区_代码调试.png)

打开局部变量窗口，查看当前帧代码所在作用域的局部变量的值信息：

![](Base64图像/Base64图像42来自_WPS%20集成模式_WPS宏编辑器开发_界面组成_主体功能窗口区_代码调试.png)

> WPS 开发文档： [WPS 集成模式/WPS宏编辑器开发/界面组成/主体功能窗口区/代码调试](https://qn.cache.wpscdn.cn/encs/doc/office_v19/topics/WPS%20%E9%9B%86%E6%88%90%E6%A8%A1%E5%BC%8F/WPS%E5%AE%8F%E7%BC%96%E8%BE%91%E5%99%A8%E5%BC%80%E5%8F%91/%E7%95%8C%E9%9D%A2%E7%BB%84%E6%88%90/%E4%B8%BB%E4%BD%93%E5%8A%9F%E8%83%BD%E7%AA%97%E5%8F%A3%E5%8C%BA/%E4%BB%A3%E7%A0%81%E8%B0%83%E8%AF%95.html)

------------------------------------------------------------------------
